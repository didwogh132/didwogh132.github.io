---
layout : single
title : "strassen algorithm"
date : 2020-04-09 18:19:00 +0900
---

# Strassen algorithm

- 배경

  슈트라센 알고리즘은 독일의 수학자 폴커 슈트라센이 1969년에 개발한 행렬 곱셈 알고리즘이다. 

- 목적

  *n*×*n* 크기의 두 행렬을 곱하면 [O](https://ko.wikipedia.org/wiki/점근_표기법)(n^3)의 시간이 소요되지만 이 알고리즘은 대략 O(n^2.807)의 시간이 소요된다.



행렬 A, B, C가 이렇게 있다고 치자.

![](https://wikimedia.org/api/rest_v1/media/math/render/svg/41c6337190684aff7b69f124226d6e62d79ebca5)

그럴 때 C=AB라고 하면 

C(1,1) = A(1,1)B(1,1)  + A(1,2)B(2,1)

C(1,2) = A(1,1)B(1,2)  + A(1,2)B(2,2)

C(2,1) = A(2,1)B(1,1)  + A(2,2)B(2,1)

C(2,2) = A(2,1)B(1,2)  + A(1,2)B(2,2)

이렇게 된다.



하지만 스트라센 알고리즘을 사용하게 되면 이러한 정의를 사용한다.

M1 = (A(1,1) + A(2,2))(B(1,1) + B(2,2))

M2 = (A(2,1) + A(2,2))B(1,1)

M3 = A(1,1)(B(1,2) - B(2,2))

M4 = A(2,2)(B(2,1) - B(1,1))

M5 = (A(1,1) + A(1,2))B(2,2)

M6 = (A(2,1) - A(1,1))(B(1,1) + B(1,2))

M7 = (A(1,2) - A(2,2))(B(2,1) + B(2,2))

그리고 이러한 정의를 이용해 C(i,j)를 표현하면

C(1,1) = M1 + M4 - M5 + M7

C(1,2) = M3 + M5

C(2,1) = M2 + M4

C(2,2) = M1 - M2 + M3 + M6

이다.

원래 행렬의 곱셈에서는 C 행렬을 구하기 위해 총 8번의 곱셈과 4번의 덧셈이 필요하다. 하지만 스트라센 알고리즘에서는 M에서 7번의 곱셈과 10번의 덧셈이 필요하다. 그리고 C 행렬을 구하기 위해 8번의 덧셈이 필요하다. 총 7번의 곱셈과 18번의 덧셈이 필요하다. 



빅오로 표현하면 기본 행렬의 곱은 n^3이고  스트라센 알고리즘은 n^2.807이 나온다.



그리고 A와 B가 2^n × 2^n의 행렬로 나오지 않으면 부족한 행과 열을 0으로 채운다.

그리고 A와 B를 정사각행렬로 표현해서 부분으로 나눠서 분할정복을 실시해 구한다.

![](http://yimoyimo.tk/images/strassen2.png)

기본 슈트라센 알고리즘 2 × 2 행렬을 C언어로 표현해보자.

```c
#include<stdio.h>
int main(){
    int a[2][2], b[2][2], c[2][2];
    int m1, m2, m3, m4, m5, m6, m7;
    
    printf("A의 행렬을 채우세요 : ");
    for(int i=0;i<2;i++)
        for(int j=0;j<2;j++)
            scanf("%d",&a[i][j]);
    
    printf("B의 행렬을 채우세요 : ");
    for(int i=0;i<2;i++)
        for(int j=0;j<2;j++)
            scanf("%d",&b[i][j]);
    
    printf("A의 행렬");
    for(int i=0;i<2;i++){
        printf("\n");
        for(int j=0;j<2;j++)
            printf("%d ",a[i][j]);
    }
    printf("A의 행렬");
    for(int i=0;i<2;i++){
        printf("\n");
        for(int j=0;j<2;j++)
            printf("%d ",b[i][j]);
    }
    
    m1 = (a[0][0] + a[1][1])*(b[0][0] + b[1][1]);
    m2 = (a[1][0] + a[1][1])*b[0][0];
    m3 = a[0][0]*(b[0][1] - b[1][1]);
    m4 = a[1][1]*(b[1][0] - b[0][0]);
    m5 = (a[0][0] + a[0][1])*b[1][1];
    m6 = (a[1][0] - a[0][0])*(b[0][0] + b[0][1]);
    m7 = (a[0][1] - a[1][1])*(b[1][0] + b[1][1]);
    
    c[0][0] = m1 + m4 - m5 + m7;
    c[0][1] = m3+ m5;
    c[1][0] = m2 + m4;
    c[1][1] = m1 + m3 - m2 + m6;
    
    printf("\n 스트라센 알고리즘을 이용해 구한 C의 행렬\n");
    for(int i=0;i<2;i++){
        printf("\n");
        for(int j=0;j<2;j++)
            printf("%d ",b[i][j]);
    }
    
    return 0;
}
```



그리고 스트라센 알고리즘을 이용해 구하는 것과 일반 행렬 곱셈으로 구할 때를 그래프로 그려보면 이렇게 나온다.

![](https://www.programmersought.com/images/450/e4d95ae55204d4bab329f2a91a7cc7ca.png)

 

